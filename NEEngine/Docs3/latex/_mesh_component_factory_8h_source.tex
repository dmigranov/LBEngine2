\hypertarget{_mesh_component_factory_8h_source}{}\doxysection{Mesh\+Component\+Factory.\+h}
\label{_mesh_component_factory_8h_source}\index{inc/MeshComponentFactory.h@{inc/MeshComponentFactory.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{2 }
\DoxyCodeLine{3 \textcolor{keyword}{class }\mbox{\hyperlink{class_mesh_component}{MeshComponent}};}
\DoxyCodeLine{4 \textcolor{keyword}{class }\mbox{\hyperlink{class_game}{Game}};}
\DoxyCodeLine{5 }
\DoxyCodeLine{6 \textcolor{keyword}{class }\mbox{\hyperlink{class_mesh_component_factory}{MeshComponentFactory}}}
\DoxyCodeLine{7 \{}
\DoxyCodeLine{8 \textcolor{keyword}{public}:}
\DoxyCodeLine{9     \textcolor{keyword}{template}<\textcolor{keyword}{class} VertexData> \textcolor{keyword}{static} \mbox{\hyperlink{class_mesh_component}{MeshComponent}}* CreateMeshComponent(\textcolor{keywordtype}{int} nv, VertexData* vertices, \textcolor{keywordtype}{int} ni, WORD* indices, D3D\_PRIMITIVE\_TOPOLOGY topology = D3D11\_PRIMITIVE\_TOPOLOGY\_TRIANGLELIST) \{}
\DoxyCodeLine{10         \textcolor{keyword}{auto}\& game = Game::GetInstance();}
\DoxyCodeLine{11         \textcolor{keyword}{auto} device = game.GetDevice();}
\DoxyCodeLine{12         \textcolor{keyword}{auto} deviceContext = game.GetDeviceContext(); \textcolor{comment}{//todo: оптимизировать}}
\DoxyCodeLine{13 }
\DoxyCodeLine{14         ID3D11Buffer* g\_d3dVertexBuffer = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{15         ID3D11Buffer* g\_d3dIndexBuffer = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{16 }
\DoxyCodeLine{17         D3D11\_BUFFER\_DESC vertexBufferDesc;}
\DoxyCodeLine{18         ZeroMemory(\&vertexBufferDesc, \textcolor{keyword}{sizeof}(D3D11\_BUFFER\_DESC));}
\DoxyCodeLine{19 }
\DoxyCodeLine{20         vertexBufferDesc.BindFlags = D3D11\_BIND\_VERTEX\_BUFFER;  \textcolor{comment}{//how the buffer is bound to pipeline}}
\DoxyCodeLine{21         vertexBufferDesc.ByteWidth = \textcolor{keyword}{sizeof}(VertexData) * nv;}
\DoxyCodeLine{22         vertexBufferDesc.CPUAccessFlags = 0;    \textcolor{comment}{// no CPU access is necessary}}
\DoxyCodeLine{23         vertexBufferDesc.Usage = D3D11\_USAGE\_DEFAULT;}
\DoxyCodeLine{24 }
\DoxyCodeLine{25         \textcolor{comment}{//used to specify the data that is used to initialize a buffer when it is created.}}
\DoxyCodeLine{26         D3D11\_SUBRESOURCE\_DATA resourceData;}
\DoxyCodeLine{27         ZeroMemory(\&resourceData, \textcolor{keyword}{sizeof}(D3D11\_SUBRESOURCE\_DATA));}
\DoxyCodeLine{28         resourceData.pSysMem = vertices; \textcolor{comment}{//A pointer to the data to initialize the buffer with.}}
\DoxyCodeLine{29         device-\/>CreateBuffer(\&vertexBufferDesc, \&resourceData, \&g\_d3dVertexBuffer);}
\DoxyCodeLine{30 }
\DoxyCodeLine{31         \textcolor{comment}{// Create and initialize the index buffer.}}
\DoxyCodeLine{32         D3D11\_BUFFER\_DESC indexBufferDesc;}
\DoxyCodeLine{33         ZeroMemory(\&indexBufferDesc, \textcolor{keyword}{sizeof}(D3D11\_BUFFER\_DESC));}
\DoxyCodeLine{34 }
\DoxyCodeLine{35         indexBufferDesc.BindFlags = D3D11\_BIND\_INDEX\_BUFFER;}
\DoxyCodeLine{36         indexBufferDesc.ByteWidth = \textcolor{keyword}{sizeof}(WORD) * ni;}
\DoxyCodeLine{37         indexBufferDesc.CPUAccessFlags = 0;}
\DoxyCodeLine{38         indexBufferDesc.Usage = D3D11\_USAGE\_DEFAULT;}
\DoxyCodeLine{39         resourceData.pSysMem = indices;}
\DoxyCodeLine{40 }
\DoxyCodeLine{41         device-\/>CreateBuffer(\&indexBufferDesc, \&resourceData, \&g\_d3dIndexBuffer);}
\DoxyCodeLine{42 }
\DoxyCodeLine{43         \mbox{\hyperlink{class_mesh_component}{MeshComponent}}* returnMesh = \textcolor{keyword}{new} \mbox{\hyperlink{class_mesh_component}{MeshComponent}}(g\_d3dVertexBuffer, g\_d3dIndexBuffer, \textcolor{keyword}{typeid}(VertexData), ni, topology);}
\DoxyCodeLine{44 }
\DoxyCodeLine{45         \textcolor{keywordflow}{return} returnMesh;}
\DoxyCodeLine{46     \}}
\DoxyCodeLine{47 \};}
\DoxyCodeLine{48 }

\end{DoxyCode}
